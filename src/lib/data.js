// Client data structure
export const clientData = {
  client1: {
    2022: {
      January: {
        week1: {
          orders: { laptop: 10, mobile: 20, tablet: 15 },
          remaining_stock: { laptop: 90, mobile: 80, tablet: 85 },
        },
        week2: {
          orders: { laptop: 5, mobile: 10, tablet: 8 },
          remaining_stock: { laptop: 85, mobile: 70, tablet: 77 },
        },
        week3: {
          orders: { laptop: 8, mobile: 12, tablet: 5 },
          remaining_stock: { laptop: 77, mobile: 58, tablet: 72 },
        },
        week4: {
          orders: { laptop: 12, mobile: 18, tablet: 10 },
          remaining_stock: { laptop: 65, mobile: 40, tablet: 62 },
        },
      },
      February: {
        week1: {
          orders: { laptop: 9, mobile: 14, tablet: 7 },
          remaining_stock: { laptop: 56, mobile: 26, tablet: 55 },
        },
        week2: {
          orders: { laptop: 6, mobile: 10, tablet: 9 },
          remaining_stock: { laptop: 50, mobile: 16, tablet: 46 },
        },
        week3: {
          orders: { laptop: 5, mobile: 8, tablet: 6 },
          remaining_stock: { laptop: 45, mobile: 8, tablet: 40 },
        },
        week4: {
          orders: { laptop: 10, mobile: 15, tablet: 12 },
          remaining_stock: { laptop: 35, mobile: 0, tablet: 28 },
        },
      },
      March: {
        week1: {
          orders: { laptop: 7, mobile: 10, tablet: 8 },
          remaining_stock: { laptop: 28, mobile: 0, tablet: 20 },
        },
        week2: {
          orders: { laptop: 6, mobile: 12, tablet: 5 },
          remaining_stock: { laptop: 22, mobile: 0, tablet: 15 },
        },
        week3: {
          orders: { laptop: 5, mobile: 10, tablet: 7 },
          remaining_stock: { laptop: 17, mobile: 0, tablet: 8 },
        },
        week4: {
          orders: { laptop: 12, mobile: 14, tablet: 9 },
          remaining_stock: { laptop: 5, mobile: 0, tablet: 0 },
        },
      },
      April: {
        week1: {
          orders: { laptop: 8, mobile: 12, tablet: 10 },
          remaining_stock: { laptop: 92, mobile: 78, tablet: 90 },
        },
        week2: {
          orders: { laptop: 6, mobile: 15, tablet: 9 },
          remaining_stock: { laptop: 86, mobile: 63, tablet: 81 },
        },
        week3: {
          orders: { laptop: 5, mobile: 10, tablet: 7 },
          remaining_stock: { laptop: 81, mobile: 53, tablet: 74 },
        },
        week4: {
          orders: { laptop: 9, mobile: 14, tablet: 12 },
          remaining_stock: { laptop: 72, mobile: 39, tablet: 62 },
        },
      },
      May: {
        week1: {
          orders: { laptop: 10, mobile: 20, tablet: 15 },
          remaining_stock: { laptop: 62, mobile: 19, tablet: 47 },
        },
        week2: {
          orders: { laptop: 5, mobile: 10, tablet: 8 },
          remaining_stock: { laptop: 57, mobile: 9, tablet: 39 },
        },
        week3: {
          orders: { laptop: 8, mobile: 12, tablet: 5 },
          remaining_stock: { laptop: 49, mobile: 0, tablet: 34 },
        },
        week4: {
          orders: { laptop: 12, mobile: 18, tablet: 10 },
          remaining_stock: { laptop: 37, mobile: 0, tablet: 24 },
        },
      },
      June: {
        week1: {
          orders: { laptop: 9, mobile: 14, tablet: 7 },
          remaining_stock: { laptop: 28, mobile: 0, tablet: 17 },
        },
        week2: {
          orders: { laptop: 6, mobile: 10, tablet: 9 },
          remaining_stock: { laptop: 22, mobile: 0, tablet: 8 },
        },
        week3: {
          orders: { laptop: 5, mobile: 8, tablet: 6 },
          remaining_stock: { laptop: 17, mobile: 0, tablet: 2 },
        },
        week4: {
          orders: { laptop: 10, mobile: 15, tablet: 12 },
          remaining_stock: { laptop: 7, mobile: 0, tablet: 0 },
        },
      },
      July: {
        week1: {
          orders: { laptop: 7, mobile: 10, tablet: 8 },
          remaining_stock: { laptop: 0, mobile: 0, tablet: 0 },
        },
        week2: {
          orders: { laptop: 6, mobile: 12, tablet: 5 },
          remaining_stock: { laptop: 0, mobile: 0, tablet: 0 },
        },
        week3: {
          orders: { laptop: 5, mobile: 10, tablet: 7 },
          remaining_stock: { laptop: 0, mobile: 0, tablet: 0 },
        },
        week4: {
          orders: { laptop: 12, mobile: 14, tablet: 9 },
          remaining_stock: { laptop: 0, mobile: 0, tablet: 0 },
        },
      },
      August: {
        week1: {
          orders: { laptop: 8, mobile: 12, tablet: 10 },
          remaining_stock: { laptop: 92, mobile: 78, tablet: 90 },
        },
        week2: {
          orders: { laptop: 6, mobile: 15, tablet: 9 },
          remaining_stock: { laptop: 86, mobile: 63, tablet: 81 },
        },
        week3: {
          orders: { laptop: 5, mobile: 10, tablet: 7 },
          remaining_stock: { laptop: 81, mobile: 53, tablet: 74 },
        },
        week4: {
          orders: { laptop: 9, mobile: 14, tablet: 12 },
          remaining_stock: { laptop: 72, mobile: 39, tablet: 62 },
        },
      },
      September: {
        week1: {
          orders: { laptop: 10, mobile: 20, tablet: 15 },
          remaining_stock: { laptop: 62, mobile: 19, tablet: 47 },
        },
        week2: {
          orders: { laptop: 5, mobile: 10, tablet: 8 },
          remaining_stock: { laptop: 57, mobile: 9, tablet: 39 },
        },
        week3: {
          orders: { laptop: 8, mobile: 12, tablet: 5 },
          remaining_stock: { laptop: 49, mobile: 0, tablet: 34 },
        },
        week4: {
          orders: { laptop: 12, mobile: 18, tablet: 10 },
          remaining_stock: { laptop: 37, mobile: 0, tablet: 24 },
        },
      },
      October: {
        week1: {
          orders: { laptop: 9, mobile: 14, tablet: 7 },
          remaining_stock: { laptop: 28, mobile: 0, tablet: 17 },
        },
        week2: {
          orders: { laptop: 6, mobile: 10, tablet: 9 },
          remaining_stock: { laptop: 22, mobile: 0, tablet: 8 },
        },
        week3: {
          orders: { laptop: 5, mobile: 8, tablet: 6 },
          remaining_stock: { laptop: 17, mobile: 0, tablet: 2 },
        },
        week4: {
          orders: { laptop: 10, mobile: 15, tablet: 12 },
          remaining_stock: { laptop: 7, mobile: 0, tablet: 0 },
        },
      },
      November: {
        week1: {
          orders: { laptop: 7, mobile: 10, tablet: 8 },
          remaining_stock: { laptop: 0, mobile: 0, tablet: 0 },
        },
        week2: {
          orders: { laptop: 6, mobile: 12, tablet: 5 },
          remaining_stock: { laptop: 0, mobile: 0, tablet: 0 },
        },
        week3: {
          orders: { laptop: 5, mobile: 10, tablet: 7 },
          remaining_stock: { laptop: 0, mobile: 0, tablet: 0 },
        },
        week4: {
          orders: { laptop: 12, mobile: 14, tablet: 9 },
          remaining_stock: { laptop: 0, mobile: 0, tablet: 0 },
        },
      },
      December: {
        week1: {
          orders: { laptop: 8, mobile: 12, tablet: 10 },
          remaining_stock: { laptop: 92, mobile: 78, tablet: 90 },
        },
        week2: {
          orders: { laptop: 6, mobile: 15, tablet: 9 },
          remaining_stock: { laptop: 86, mobile: 63, tablet: 81 },
        },
        week3: {
          orders: { laptop: 5, mobile: 10, tablet: 7 },
          remaining_stock: { laptop: 81, mobile: 53, tablet: 74 },
        },
        week4: {
          orders: { laptop: 9, mobile: 14, tablet: 12 },
          remaining_stock: { laptop: 72, mobile: 39, tablet: 62 },
        },
      },
    },
    2023: {
      January: {
        week1: {
          orders: { laptop: 10, mobile: 20, tablet: 15 },
          remaining_stock: { laptop: 62, mobile: 19, tablet: 47 },
        },
        week2: {
          orders: { laptop: 5, mobile: 10, tablet: 8 },
          remaining_stock: { laptop: 57, mobile: 9, tablet: 39 },
        },
        week3: {
          orders: { laptop: 8, mobile: 12, tablet: 5 },
          remaining_stock: { laptop: 49, mobile: 0, tablet: 34 },
        },
        week4: {
          orders: { laptop: 12, mobile: 18, tablet: 10 },
          remaining_stock: { laptop: 37, mobile: 0, tablet: 24 },
        },
      },
      February: {
        week1: {
          orders: { laptop: 9, mobile: 14, tablet: 7 },
          remaining_stock: { laptop: 28, mobile: 0, tablet: 17 },
        },
        week2: {
          orders: { laptop: 6, mobile: 10, tablet: 9 },
          remaining_stock: { laptop: 22, mobile: 0, tablet: 8 },
        },
        week3: {
          orders: { laptop: 5, mobile: 8, tablet: 6 },
          remaining_stock: { laptop: 17, mobile: 0, tablet: 2 },
        },
        week4: {
          orders: { laptop: 10, mobile: 15, tablet: 12 },
          remaining_stock: { laptop: 7, mobile: 0, tablet: 0 },
        },
      },
      March: {
        week1: {
          orders: { laptop: 7, mobile: 10, tablet: 8 },
          remaining_stock: { laptop: 0, mobile: 0, tablet: 0 },
        },
        week2: {
          orders: { laptop: 6, mobile: 12, tablet: 5 },
          remaining_stock: { laptop: 0, mobile: 0, tablet: 0 },
        },
        week3: {
          orders: { laptop: 5, mobile: 10, tablet: 7 },
          remaining_stock: { laptop: 0, mobile: 0, tablet: 0 },
        },
        week4: {
          orders: { laptop: 12, mobile: 14, tablet: 9 },
          remaining_stock: { laptop: 0, mobile: 0, tablet: 0 },
        },
      },
      April: {
        week1: {
          orders: { laptop: 8, mobile: 12, tablet: 10 },
          remaining_stock: { laptop: 92, mobile: 78, tablet: 90 },
        },
        week2: {
          orders: { laptop: 6, mobile: 15, tablet: 9 },
          remaining_stock: { laptop: 86, mobile: 63, tablet: 81 },
        },
        week3: {
          orders: { laptop: 5, mobile: 10, tablet: 7 },
          remaining_stock: { laptop: 81, mobile: 53, tablet: 74 },
        },
        week4: {
          orders: { laptop: 9, mobile: 14, tablet: 12 },
          remaining_stock: { laptop: 72, mobile: 39, tablet: 62 },
        },
      },
      May: {
        week1: {
          orders: { laptop: 10, mobile: 20, tablet: 15 },
          remaining_stock: { laptop: 62, mobile: 19, tablet: 47 },
        },
        week2: {
          orders: { laptop: 5, mobile: 10, tablet: 8 },
          remaining_stock: { laptop: 57, mobile: 9, tablet: 39 },
        },
        week3: {
          orders: { laptop: 8, mobile: 12, tablet: 5 },
          remaining_stock: { laptop: 49, mobile: 0, tablet: 34 },
        },
        week4: {
          orders: { laptop: 12, mobile: 18, tablet: 10 },
          remaining_stock: { laptop: 37, mobile: 0, tablet: 24 },
        },
      },
      June: {
        week1: {
          orders: { laptop: 9, mobile: 14, tablet: 7 },
          remaining_stock: { laptop: 28, mobile: 0, tablet: 17 },
        },
        week2: {
          orders: { laptop: 6, mobile: 10, tablet: 9 },
          remaining_stock: { laptop: 22, mobile: 0, tablet: 8 },
        },
        week3: {
          orders: { laptop: 5, mobile: 8, tablet: 6 },
          remaining_stock: { laptop: 17, mobile: 0, tablet: 2 },
        },
        week4: {
          orders: { laptop: 10, mobile: 15, tablet: 12 },
          remaining_stock: { laptop: 7, mobile: 0, tablet: 0 },
        },
      },
      July: {
        week1: {
          orders: { laptop: 7, mobile: 10, tablet: 8 },
          remaining_stock: { laptop: 0, mobile: 0, tablet: 0 },
        },
        week2: {
          orders: { laptop: 6, mobile: 12, tablet: 5 },
          remaining_stock: { laptop: 0, mobile: 0, tablet: 0 },
        },
        week3: {
          orders: { laptop: 5, mobile: 10, tablet: 7 },
          remaining_stock: { laptop: 0, mobile: 0, tablet: 0 },
        },
        week4: {
          orders: { laptop: 12, mobile: 14, tablet: 9 },
          remaining_stock: { laptop: 0, mobile: 0, tablet: 0 },
        },
      },
      August: {
        week1: {
          orders: { laptop: 8, mobile: 12, tablet: 10 },
          remaining_stock: { laptop: 92, mobile: 78, tablet: 90 },
        },
        week2: {
          orders: { laptop: 6, mobile: 15, tablet: 9 },
          remaining_stock: { laptop: 86, mobile: 63, tablet: 81 },
        },
        week3: {
          orders: { laptop: 5, mobile: 10, tablet: 7 },
          remaining_stock: { laptop: 81, mobile: 53, tablet: 74 },
        },
        week4: {
          orders: { laptop: 9, mobile: 14, tablet: 12 },
          remaining_stock: { laptop: 72, mobile: 39, tablet: 62 },
        },
      },
      September: {
        week1: {
          orders: { laptop: 10, mobile: 20, tablet: 15 },
          remaining_stock: { laptop: 62, mobile: 19, tablet: 47 },
        },
        week2: {
          orders: { laptop: 5, mobile: 10, tablet: 8 },
          remaining_stock: { laptop: 57, mobile: 9, tablet: 39 },
        },
        week3: {
          orders: { laptop: 8, mobile: 12, tablet: 5 },
          remaining_stock: { laptop: 49, mobile: 0, tablet: 34 },
        },
        week4: {
          orders: { laptop: 12, mobile: 18, tablet: 10 },
          remaining_stock: { laptop: 37, mobile: 0, tablet: 24 },
        },
      },
      October: {
        week1: {
          orders: { laptop: 9, mobile: 14, tablet: 7 },
          remaining_stock: { laptop: 28, mobile: 0, tablet: 17 },
        },
        week2: {
          orders: { laptop: 6, mobile: 10, tablet: 9 },
          remaining_stock: { laptop: 22, mobile: 0, tablet: 8 },
        },
        week3: {
          orders: { laptop: 5, mobile: 8, tablet: 6 },
          remaining_stock: { laptop: 17, mobile: 0, tablet: 2 },
        },
        week4: {
          orders: { laptop: 10, mobile: 15, tablet: 12 },
          remaining_stock: { laptop: 7, mobile: 0, tablet: 0 },
        },
      },
      November: {
        week1: {
          orders: { laptop: 7, mobile: 10, tablet: 8 },
          remaining_stock: { laptop: 0, mobile: 0, tablet: 0 },
        },
        week2: {
          orders: { laptop: 6, mobile: 12, tablet: 5 },
          remaining_stock: { laptop: 0, mobile: 0, tablet: 0 },
        },
        week3: {
          orders: { laptop: 5, mobile: 10, tablet: 7 },
          remaining_stock: { laptop: 0, mobile: 0, tablet: 0 },
        },
        week4: {
          orders: { laptop: 12, mobile: 14, tablet: 9 },
          remaining_stock: { laptop: 0, mobile: 0, tablet: 0 },
        },
      },
      December: {
        week1: {
          orders: { laptop: 8, mobile: 12, tablet: 10 },
          remaining_stock: { laptop: 92, mobile: 78, tablet: 90 },
        },
        week2: {
          orders: { laptop: 6, mobile: 15, tablet: 9 },
          remaining_stock: { laptop: 86, mobile: 63, tablet: 81 },
        },
        week3: {
          orders: { laptop: 5, mobile: 10, tablet: 7 },
          remaining_stock: { laptop: 81, mobile: 53, tablet: 74 },
        },
        week4: {
          orders: { laptop: 9, mobile: 14, tablet: 12 },
          remaining_stock: { laptop: 72, mobile: 39, tablet: 62 },
        },
      },
    },
  },
};

// Helper functions for data processing
export const getMonthlyData = (data, year, product) => {
  // Check if data and year exist
  if (!data || !data[year]) {
    return [];
  }

  const months = Object.keys(data[year]);

  return months.map((month) => {
    const monthData = data[year][month];
    if (!monthData) return { name: month.substring(0, 3), orders: 0 };

    const weeks = Object.keys(monthData);

    let totalOrders = 0;

    if (product === "all") {
      weeks.forEach((week) => {
        if (monthData[week] && monthData[week].orders) {
          totalOrders +=
            monthData[week].orders.laptop +
            monthData[week].orders.mobile +
            monthData[week].orders.tablet;
        }
      });
    } else {
      weeks.forEach((week) => {
        if (
          monthData[week] &&
          monthData[week].orders &&
          monthData[week].orders[product]
        ) {
          totalOrders += monthData[week].orders[product];
        }
      });
    }

    return {
      name: month.substring(0, 3),
      orders: totalOrders,
    };
  });
};

// Similarly update other data processing functions
export const getStockData = (data, year, product) => {
  if (!data || !data[year]) {
    return [];
  }

  const months = Object.keys(data[year]);

  return months.map((month) => {
    const monthData = data[year][month];
    if (!monthData)
      return { name: month.substring(0, 3), laptop: 0, mobile: 0, tablet: 0 };

    const lastWeek = Object.keys(monthData).pop();
    if (
      !lastWeek ||
      !monthData[lastWeek] ||
      !monthData[lastWeek].remaining_stock
    ) {
      return { name: month.substring(0, 3), laptop: 0, mobile: 0, tablet: 0 };
    }

    const stock = monthData[lastWeek].remaining_stock;

    return {
      name: month.substring(0, 3),
      laptop: stock.laptop || 0,
      mobile: stock.mobile || 0,
      tablet: stock.tablet || 0,
      [product]: product !== "all" ? stock[product] || 0 : undefined,
    };
  });
};

export const getProductDistribution = (data, year) => {
  if (!data || !data[year]) {
    return [
      { name: "Laptop", value: 0, percent: 0 },
      { name: "Mobile", value: 0, percent: 0 },
      { name: "Tablet", value: 0, percent: 0 },
    ];
  }

  let laptopTotal = 0;
  let mobileTotal = 0;
  let tabletTotal = 0;

  const months = Object.keys(data[year]);

  months.forEach((month) => {
    if (!data[year][month]) return;

    const monthData = data[year][month];
    const weeks = Object.keys(monthData);

    weeks.forEach((week) => {
      if (monthData[week] && monthData[week].orders) {
        laptopTotal += monthData[week].orders.laptop || 0;
        mobileTotal += monthData[week].orders.mobile || 0;
        tabletTotal += monthData[week].orders.tablet || 0;
      }
    });
  });

  const total = laptopTotal + mobileTotal + tabletTotal;

  return [
    {
      name: "Laptop",
      value: laptopTotal,
      percent: total > 0 ? Math.round((laptopTotal / total) * 100) : 0,
    },
    {
      name: "Mobile",
      value: mobileTotal,
      percent: total > 0 ? Math.round((mobileTotal / total) * 100) : 0,
    },
    {
      name: "Tablet",
      value: tabletTotal,
      percent: total > 0 ? Math.round((tabletTotal / total) * 100) : 0,
    },
  ];
};

export const getYearlyComparison = (data, product) => {
  if (!data || !data["2022"] || !data["2023"]) {
    return [];
  }

  const months = Object.keys(data["2022"]).slice(0, 12);

  return months.map((month) => {
    const data2022 = data["2022"][month];
    const data2023 = data["2023"][month];

    if (!data2022 || !data2023) {
      return { name: month.substring(0, 3), 2022: 0, 2023: 0 };
    }

    const weeks2022 = Object.keys(data2022);
    const weeks2023 = Object.keys(data2023);

    let orders2022 = 0;
    let orders2023 = 0;

    if (product === "all") {
      weeks2022.forEach((week) => {
        if (data2022[week] && data2022[week].orders) {
          orders2022 +=
            data2022[week].orders.laptop +
            data2022[week].orders.mobile +
            data2022[week].orders.tablet;
        }
      });

      weeks2023.forEach((week) => {
        if (data2023[week] && data2023[week].orders) {
          orders2023 +=
            data2023[week].orders.laptop +
            data2023[week].orders.mobile +
            data2023[week].orders.tablet;
        }
      });
    } else {
      weeks2022.forEach((week) => {
        if (
          data2022[week] &&
          data2022[week].orders &&
          data2022[week].orders[product]
        ) {
          orders2022 += data2022[week].orders[product];
        }
      });

      weeks2023.forEach((week) => {
        if (
          data2023[week] &&
          data2023[week].orders &&
          data2023[week].orders[product]
        ) {
          orders2023 += data2023[week].orders[product];
        }
      });
    }

    return {
      name: month.substring(0, 3),
      2022: orders2022,
      2023: orders2023,
    };
  });
};
